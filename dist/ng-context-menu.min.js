angular.module("ng-context-menu",[]).service("contextMenu",function(){var e,n,t=[];e=function(e){e.removeClass("open"),t.forEach(function(n){n.element===e&&(n.isOpen=!1)})},n=function(n,o){var i,u;t.forEach(function(n){n.element===o?i=n:n.isOpen&&(e(n.element),n.isOpen=!1)}),i||(i={isOpen:!1,element:o},t.push(i)),i.isOpen||(u=angular.element(n.target).offset(),o.css("top",(n.offsetY||n.clientY-u.top)+"px"),o.css("left",(n.offsetX||n.clientX-u.left)+"px"),o.addClass("open"),i.isOpen=!0)},this.closeMenu=e,this.openMenu=n}).directive("contextMenu",["$window","$parse","contextMenu",function(e,n,t){return{restrict:"A",link:function(o,i,u){function c(e){!l||s||2===e.button&&e.target===a||o.$apply(function(){t.closeMenu(l)})}var l,a,s=o.$eval(u.contextMenuDisabled),p=angular.element(e),f=n(u.contextMenu);i.bind("contextmenu",function(e){s||(void 0===l&&(l=angular.element(document.getElementById(u.target))),a=e.target,e.preventDefault(),e.stopPropagation(),o.$apply(function(){f(o,{$event:e}),t.openMenu(e,l)}))}),p.bind("keyup",function(e){l&&!s&&27===e.keyCode&&o.$apply(function(){t.closeMenu(l)})}),p.bind("click",c),p.bind("contextmenu",c)}}}]);