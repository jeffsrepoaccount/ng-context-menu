angular.module("ng-context-menu",[]).service("contextMenu",function(){var e,n,t=[];e=function(e){e.removeClass("open"),t.forEach(function(n){n.element===e&&(n.isOpen=!1)})},n=function(n,o){var u,c;t.forEach(function(n){n.element===o?u=n:n.isOpen&&e(n.element)}),u||(u={isOpen:!1,element:o},t.push(u)),u.isOpen||(c=angular.element(n.target).offset(),o.css("top",(n.offsetY||n.clientY-c.top)+"px"),o.css("left",(n.offsetX||n.clientX-c.left)+"px"),o.addClass("open"),u.isOpen=!0)},this.closeMenu=e,this.openMenu=n}).directive("contextMenu",["$window","$parse","contextMenu",function(e,n,t){return{restrict:"A",link:function(o,u,c){function i(e){!l||s||2===e.button&&e.target===a||o.$apply(function(){t.closeMenu(l)})}var l,a,s=o.$eval(c.contextMenuDisabled),p=angular.element(e),f=n(c.contextMenu);u.bind("contextmenu",function(e){s||(void 0===l&&(l=angular.element(document.getElementById(c.target))),a=e.target,e.preventDefault(),e.stopPropagation(),o.$apply(function(){f(o,{$event:e}),t.openMenu(e,l)}))}),p.bind("keyup",function(e){l&&!s&&27===e.keyCode&&o.$apply(function(){t.closeMenu(l)})}),p.bind("click",i),p.bind("contextmenu",i)}}}]);